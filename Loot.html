<script>
  function extractDigits(text) {
    // ดึงเลขเดี่ยวทั้งหมดตามลำดับ โดยไม่ลบซ้ำ
    return text.match(/\d/g) || [];
  }

  function generate() {
    const input = document.getElementById("input").value;
    const digits = extractDigits(input);
    const resultDiv = document.getElementById("results");
    resultDiv.innerHTML = "";

    if (digits.length === 0) {
      resultDiv.innerHTML = "<p class='red'>กรุณาใส่เลขก่อนนะ</p>";
      return;
    }

    const allResults = [];

    digits.forEach((digit, index) => {
      const nums = [];
      for (let i = 0; i <= 9; i++) {
        nums.push(`${i}${digit}`);
        nums.push(`${digit}${i}`);
      }
      const uniqueNums = [...new Set(nums)];
      const resultText = `[${index + 1}] รูด ${digit}: ${uniqueNums.join(' ')}`;
      allResults.push(resultText);

      const box = document.createElement("div");
      box.className = "result-box";
      box.innerHTML = `<div class="red">${resultText}</div>`;
      resultDiv.appendChild(box);
    });

    // ปุ่มคัดลอกทั้งหมด
    const copyBtn = document.createElement("button");
    copyBtn.className = "copy-btn";
    copyBtn.innerText = "คัดลอกทั้งหมด";
    copyBtn.onclick = () => copyText(allResults.join('\n'));
    resultDiv.appendChild(copyBtn);

    const copiedMsg = document.createElement("span");
    copiedMsg.id = "copied-msg";
    copiedMsg.className = "copied-msg";
    copiedMsg.style.display = "none";
    copiedMsg.innerText = "คัดลอกแล้ว!";
    resultDiv.appendChild(copiedMsg);
  }

  function copyText(text) {
    navigator.clipboard.writeText(text).then(() => {
      const msg = document.getElementById("copied-msg");
      msg.style.display = "inline-block";
      setTimeout(() => msg.style.display = "none", 2000);
    });
  }

  function clearAll() {
    document.getElementById("input").value = "";
    document.getElementById("results").innerHTML = "";
  }

  function checkEnter(e) {
    if (e.key === "Enter") {
      generate();
    }
  }
</script>
