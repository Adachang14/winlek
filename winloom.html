<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏ß‡∏¥‡∏ô‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏° (2‡∏ï‡∏±‡∏ß+3‡∏ï‡∏±‡∏ß)</title>

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700;800&display=swap" rel="stylesheet">

<style>
  body{
    font-family:'Sarabun',sans-serif;
    background:#f3e5f5;
    padding:20px;
    text-align:center;
  }
  .box{
    max-width:650px;
    margin:auto;
    background:#fff;
    padding:22px;
    border-radius:18px;
    box-shadow:0 8px 22px rgba(0,0,0,.15);
  }
  h2{ color:#8e24aa; margin:0 0 14px; }

  textarea{
    width:100%;
    height:250px;
    font-size:18px;
    padding:12px;
    border-radius:12px;
    border:1px solid #ddd;
    outline:none;
    resize: vertical;
  }
  textarea:focus {
    border-color: #8e24aa;
    box-shadow: 0 0 8px rgba(142, 36, 170, 0.2);
    background-color: #fdfaff; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå */
  }

  /* ‡πÅ‡∏ñ‡∏ß‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏•‡∏±‡∏Å */
  .btn-row{
    margin-top:14px;
    display:flex;
    gap:8px;
    justify-content:center;
    flex-wrap:wrap;
  }
  
  /* ‡πÅ‡∏ñ‡∏ß‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° */
  .btn-row-sub{
    margin-top:10px;
    display:flex;
    gap:8px;
    justify-content:center;
    flex-wrap:wrap;
    padding-top: 10px;
    border-top: 1px dashed #ddd;
  }

  button{
    padding:10px 18px;
    font-size:15px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    color:#fff;
    font-weight: bold;
    transition: transform 0.1s;
  }
  button:active { transform: scale(0.95); }
  
  .btn-run{ background:#8e24aa; }
  .btn-clear{ background:#ff5722; }
  .btn-copy-all{ background:#2196f3; }
  .btn-home{ background:#607d8b; }
  
  .btn-copy-2{ background:#00897b; }
  .btn-copy-3{ background:#d81b60; }

  .result{
    margin-top:18px;
    text-align:left;
    background:#f8eafc;
    padding:16px;
    border-radius:14px;
    white-space:pre-wrap;
    word-break:break-word;
    line-height:1.6;
    font-size: 16px;
  }

  .copied-msg{
    display:none;
    margin-top:10px;
    color:green;
    font-weight:800;
  }
</style>
</head>

<body>
<div class="box">
  <h2>‡∏ß‡∏¥‡∏ô‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏° (‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á 2 ‡πÅ‡∏•‡∏∞ 3 ‡∏ï‡∏±‡∏ß)</h2>

  <textarea id="input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå/‡∏ß‡∏≤‡∏á‡πÄ‡∏•‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô
123
4567"></textarea>

  <div class="btn-row">
    <button class="btn-run" onclick="run()">‡∏ß‡∏¥‡∏ô‡πÄ‡∏•‡∏Ç‡∏£‡∏ß‡∏°</button>
    <button class="btn-clear" onclick="resetAll()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    <button class="btn-copy-all" onclick="copyAllMixed()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    <button class="btn-home" onclick="goHome()">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
  </div>

  <div class="btn-row-sub">
    <button class="btn-copy-2" onclick="copyOnlyDigit(2)">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 2 ‡∏ï‡∏±‡∏ß</button>
    <button class="btn-copy-3" onclick="copyOnlyDigit(3)">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 3 ‡∏ï‡∏±‡∏ß</button>
  </div>

  <div id="copied" class="copied-msg">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!</div>
  <div id="output" class="result"></div>
</div>

<script>
  const MIN_LEN = 3;
  let globalResults = [];

  function toThaiNumber(n){
    const th = ['‡πê','‡πë','‡πí','‡πì','‡πî','‡πï','‡πñ','‡πó','‡πò','‡πô'];
    return n.toString().split('').map(d => th[+d] ?? d).join('');
  }

  function hasDuplicates(str){
    return /(.).*\1/.test(str);
  }

  function normalizeToSets(raw){
    const cleaned = raw.replace(/[^\d]+/g, '\n').trim();
    if(!cleaned) return [];
    return cleaned.split(/\n+/).map(s => s.trim()).filter(Boolean);
  }

  function getCombinations(chars, size) {
    let result = [];
    const combine = (current, start) => {
      if (current.length === size) {
        result.push(current.join(''));
        return;
      }
      for (let i = start; i < chars.length; i++) {
        combine([...current, chars[i]], i + 1);
      }
    };
    combine([], 0);
    return result;
  }

  function validateSets(sets){
    let realIndex = 0;
    const bad = [];
    for (let i=0;i<sets.length;i++){
      const num = sets[i];
      if(!num) continue;
      realIndex++;
      if(num.length < MIN_LEN){
        bad.push(`‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà${toThaiNumber(realIndex)} (${num})`);
        continue;
      }
      if(hasDuplicates(num)){
        alert("‚ùóÔ∏è‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥ ‡πÄ‡πÄ‡∏à‡πâ‡∏á‡∏•‡∏Ñ.= ‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥‡∏à‡πâ‡∏≤ ‡πÅ‡∏≠‡∏î‡∏Ç‡∏≠‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡∏°‡πà‡∏à‡πâ‡∏≤‡∏û‡∏µ‡πà\n(‡∏û‡∏ö‡πÉ‡∏ô‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà " + toThaiNumber(realIndex) + " : " + num + ")");
        return { ok:false };
      }
    }
    if(bad.length){
      alert("‚ùóÔ∏è‡∏°‡∏µ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î (‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏ï‡∏±‡∏ß)\n" + bad.join("\n") + "\n\n‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏ß‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà");
      return { ok:false };
    }
    return { ok:true };
  }

  function run(){
    const raw = document.getElementById("input").value;
    const sets = normalizeToSets(raw);
    if(sets.length === 0){
      document.getElementById("output").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏ï‡∏±‡∏ß‡∏ï‡πà‡∏≠‡∏ä‡∏∏‡∏î";
      document.getElementById("copied").style.display = "none";
      return;
    }
    const v = validateSets(sets);
    if(!v.ok){
      document.getElementById("output").textContent = "";
      return;
    }
    let out = "";
    let count = 0;
    globalResults = [];
    sets.forEach((num) => {
      count++;
      const digits = num.split('');
      const pairs = getCombinations(digits, 2);
      const triplets = getCombinations(digits, 3);
      globalResults.push({ id: count, pairs: pairs, triplets: triplets });
      out += `‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà${toThaiNumber(count)}\n`;
      out += pairs.join(" ") + "\n";
      out += triplets.join(" ") + "\n\n";
    });
    document.getElementById("output").textContent = out.trim();
    document.getElementById("copied").style.display = "none";
  }

  function resetAll(){
    document.getElementById("input").value = "";
    document.getElementById("output").textContent = "";
    document.getElementById("copied").style.display = "none";
    globalResults = [];
    setTimeout(() => focusInput(true), 50);
  }

  function copyAllMixed(){
    const raw = document.getElementById("output").textContent;
    if(!raw.trim()) return;
    const cleanText = raw.replace(/^‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà.*$/gm, "").replace(/^\s*[\r\n]/gm, ""); 
    copyToClipboard(cleanText, "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!");
  }

  function copyOnlyDigit(digits){
    if(globalResults.length === 0) return;
    let textToCopy = "";
    globalResults.forEach(item => {
        if(digits === 2 && item.pairs.length > 0) textToCopy += item.pairs.join(" ") + " ";
        else if(digits === 3 && item.triplets.length > 0) textToCopy += item.triplets.join(" ") + " ";
    });
    if(!textToCopy.trim()) {
        alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏Ç " + digits + " ‡∏ï‡∏±‡∏ß ‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å");
        return;
      }
    copyToClipboard(textToCopy.trim(), `‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ${digits} ‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡πâ‡∏ß!`);
  }

  function copyToClipboard(text, alertMsg){
    navigator.clipboard.writeText(text).then(() => {
      const msg = document.getElementById("copied");
      msg.textContent = alertMsg;
      msg.style.display = "block";
      setTimeout(() => msg.style.display = "none", 1500);
    });
  }

  function goHome(){ window.location.href = "index.html"; }

  document.getElementById("input").addEventListener("keydown", function(e){
    if(e.key === "Enter" && !e.shiftKey){ e.preventDefault(); run(); }
  });

  document.getElementById("input").addEventListener("input", function(){
    const before = this.value;
    const after = before.replace(/[^\d]+/g, '\n');
    if(before !== after) this.value = after;
  });

  // =======================================================
  // üî• ‡∏£‡∏∞‡∏ö‡∏ö Super Auto Focus (‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ó‡πá‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏î‡πâ‡∏á)
  // =======================================================
  let lockUntil = 0;
  let isPointerDown = false;

  function now() { return Date.now(); }

  // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏Ñ‡∏•‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏°
  function hasSelection() {
    const sel = window.getSelection && window.getSelection();
    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Selection) ‡∏≠‡∏¢‡∏π‡πà ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏¢‡πà‡∏á Focus
    return sel && sel.rangeCount > 0 && sel.toString().length > 0;
  }

  function shouldSkipFocus() {
    if (now() < lockUntil) return true; 
    if (isPointerDown) return true;
    if (hasSelection()) return true;

    const ae = document.activeElement;
    if (ae && ae.id === 'input') return true; // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á input ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏à‡∏ö
    return false;
  }

  function focusInput(selectAll = true) {
    if (shouldSkipFocus()) return;
    
    const el = document.getElementById('input');
    if (!el) return;

    // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö Focus
    el.focus({ preventScroll: true });
    
    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏î‡∏ß‡∏≤‡∏á‡∏ó‡∏±‡∏ö)
    if (selectAll) {
      try { el.select(); } catch (_) {}
    }
  }

  // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡πâ‡∏á Focus ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
  const resultsEl = document.getElementById('output');
  if (resultsEl) {
    resultsEl.addEventListener('pointerdown', () => { lockUntil = now() + 2500; }, { passive: true });
    resultsEl.addEventListener('wheel', () => { lockUntil = now() + 2500; }, { passive: true });
  }
  document.addEventListener('pointerdown', () => { isPointerDown = true; }, { passive: true });
  document.addEventListener('pointerup',   () => { isPointerDown = false; }, { passive: true });

  // 1. ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
  window.addEventListener('load', () => setTimeout(() => focusInput(true), 100));

  // 2. ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏•‡∏±‡∏ö Tab (Visibility Change) ‚úÖ ‡∏ï‡∏±‡∏ß‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å
  document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
      // ‡∏£‡∏≠ 0.1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏ß‡πà‡∏≤‡πÅ‡∏ó‡πá‡∏ö‡∏ï‡∏∑‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß
      setTimeout(() => focusInput(true), 100);
    }
  });

  // 3. ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏•‡∏±‡∏ö Window (Focus)
  window.addEventListener('focus', function() {
    setTimeout(() => focusInput(true), 100);
  });

</script>
</body>
</html>
