<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>โปรแกรมวินเลข</title>
  <style>
    body { font-family: sans-serif; background: #eee; padding: 1rem; text-align: center; }
    input[type="text"] { padding: 0.5rem; font-size: 1rem; width: 150px; text-align: center; }
    .result-box { background: #ccffe0; border-radius: 10px; padding: 1rem; margin-top: 1rem; display: inline-block; }
    .result-section { margin-bottom: 1rem; }
    .result-section b { color: red; }
    button { margin: 0.25rem; padding: 0.5rem 1rem; cursor: pointer; font-size: 1rem; }
    .copied { color: green; font-size: 0.9rem; margin-left: 5px; }
  </style>
</head>
<body>
  <h2>โปรแกรมวินเลขจากหน้ามาหลัง</h2>
  <p>ป้อนเลขที่ต้องการวิน อย่างน้อย 3 ตัว</p>
  <input type="text" id="input" maxlength="7" placeholder="เช่น 1234567" />
  <div>
    <button onclick="generate()">วินเลข</button>
  </div>
  <div id="results"></div>

  <script>
    document.getElementById("input").addEventListener("keydown", function(e) {
      if (e.key === "Enter") generate();
    });

    function generate() {
      const input = document.getElementById("input").value.trim();

      if (input.length < 3 || digits.length > 10) {

        alert("กรุณากรอกเลขอย่างน้อย 3 ตัว และไม่เกิน 7 ตัว");
        return;
      }
      if (input.length > 7) {
        alert("วินได้ไม่เกิน 7 ตัว กรุณากรอกใหม่");
        return;
      }
      if (hasDuplicates(input)) {
        alert("❗ เลขซ้ำ กรุณากรอกใหม่");
        return;
      }

      const result2 = permute(input.split(''), 2);
      const result3 = permute(input.split(''), 3);

      const result2All = getAllCombos(input, 2);
      const result3All = getAllCombos(input, 3);

      document.getElementById("results").innerHTML = `
        <div class="result-box">
          <div><strong>เลขเด่น ${input}</strong></div><br>

          <div class="result-section">
            <div><b>เลข 3 ตัว ไม่รวมเบิ้ล</b></div>
            ${formatResults(result3)}
          </div>

          <div class="result-section">
            <div><b>เลข 2 ตัว ไม่รวมเบิ้ล</b></div>
            ${formatResults(result2)}
          </div>

          <div class="result-section">
            <div><b>เลข 3 ตัว รวมเบิ้ล</b></div>
            ${formatResults(result3All)}
          </div>

          <div class="result-section">
            <div><b>เลข 2 ตัว รวมเบิ้ล</b></div>
            ${formatResults(result2All)}
          </div>
        </div>
      `;
    }

    function hasDuplicates(str) {
      return new Set(str).size !== str.length;
    }

    function permute(arr, len) {
      let results = new Set();
      const generate = (prefix, rest) => {
        if (prefix.length === len) {
          results.add(prefix.join(""));
          return;
        }
        for (let i = 0; i < rest.length; i++) {
          generate([...prefix, rest[i]], rest.slice(0, i).concat(rest.slice(i + 1)));
        }
      };
      generate([], arr);
      return Array.from(results).sort();
    }

    function getAllCombos(str, len) {
      let results = new Set();
      const combine = (prefix, pos) => {
        if (prefix.length === len) {
          results.add(prefix);
          return;
        }
        for (let i = pos; i < str.length; i++) {
          combine(prefix + str[i], i);
        }
      };
      combine("", 0);
      return Array.from(results).sort();
    }

    function formatResults(arr) {
      const joined = arr.join(" - ");
      return `
        <div>${joined} <br>(รวม ${arr.length} ชุด)</div>
        <button onclick="copyToClipboard('${arr.join(' ')}', this)">คัดลอก</button>
        <span class="copied"></span>
      `;
    }

    function copyToClipboard(text, btn) {
      navigator.clipboard.writeText(text).then(() => {
        const span = btn.nextElementSibling;
        span.textContent = "คัดลอกแล้ว!";
        setTimeout(() => span.textContent = "", 2000);
      });
    }
  </script>
</body>
</html>
